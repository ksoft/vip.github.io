<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jlt.datasync.mapper.saas.MonAlertRuleMapper">
    <resultMap type="com.jlt.datasync.domain.MonAlertRule" id="monAlertRuleResultMap">
        <result property="id" column="id"/>
        <result property="tenantId" column="tenant_id"/>
        <result property="alertRuleType" column="alert_rule_type"/>
        <result property="alertRuleCode" column="alert_rule_code"/>
        <result property="isEnable" column="is_enable"/>
        <result property="isTemperature" column="is_temperature"/>
        <result property="temperatureCycleAlert" column="temperature_cycle_alert"/>
        <result property="temperatureDataAlert" column="temperature_data_alert"/>
        <result property="creator" column="creator"/>
        <result property="createName" column="create_name"/>
        <result property="createTime" column="create_time"/>
        <result property="modifier" column="modifier"/>
        <result property="modifyName" column="modify_name"/>
        <result property="modifyTime" column="modify_time"/>
    </resultMap>
    <sql id="select">
		<![CDATA[

			SELECT
					id,
					tenant_id,
					alert_rule_type,
					alert_rule_code,
					is_enable,
					is_temperature,
					temperature_cycle_alert,
					temperature_data_alert,
					creator,
					create_name,
					create_time,
					modifier,
					modify_name,
					modify_time

        ]]>
	</sql>

    <sql id="findByExample">
        WHERE 1=1
        <if test="id!=null">AND ID = #{id}</if>
        <if test="tenantId!=null">AND tenant_id = #{tenantId}</if>
    </sql>

    <select id="findTemperatureAlertRule" resultMap="monAlertRuleResultMap"
            parameterType="com.jlt.datasync.condition.MonAlertRuleCondition">
        <include refid="select"/>
        from mon_alert_rule
        <include refid="findByExample"/>
        and alert_rule_code = 'TEMPERATURE_EXCEEDED_ALARM'
        limit 1
    </select>
</mapper>
